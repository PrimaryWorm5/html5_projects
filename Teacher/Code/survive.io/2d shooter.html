<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	<canvas id="canvas"></canvas>
<script type="text/javascript">
document.addEventListener('keydown', keyDown, false);
document.addEventListener('keyup', keyUp, false);
document.addEventListener('mousemove', mouse);
var canvas = document.getElementById('canvas')
var ctx = canvas.getContext("2d")
canvas.width = window.innerWidth
canvas.height = window.innerHeight
var x = 100,
y = 100,
hero_rotate = 0,
mx = 0,
my = 0,
dx = 0,
dy = 0,
r = 0;
var rightPressed = false;
var leftPressed = false;
var upPressed = false;
var downPressed = false;
var tree = new Image();
    tree.src = "tree.png"
var box = new Image();
    box.src = "box.png"



function draw(){
	// ctx.clearRect(0,0,innerWidth,innerHeight)
	ctx.beginPath()
	ctx.arc(x,y,30,hero_rotate,hero_rotate+6.2)
	ctx.fillStyle = "green"
	ctx.fill()
	ctx.lineWidth = 5
	// ctx.lineTo(mx,my)
	ctx.stroke()
	for(var i=0;i<countshots;i++){
		var s = shots[i];
		ctx.beginPath()
		ctx.arc(s.x,s.y,5,0,7)
		ctx.fill()
		s.x+=s.vx;
		s.y+=s.vy;
		s.vx=1
	}
	if (rightPressed){
		x+=3
	}
	if (leftPressed){
		x-=3
	}
	if (upPressed) {
		y-=3
	}
	if (downPressed){
		y+=3
	}
	dx=x-mx
	dy=y-my
	var tan =dy/dx
	var atan = Math.atan(tan)*180/Math.PI;
	if(dx>=0 && dy>=0){atan+=180;}
	else if(dx>=0 && dy<=0){atan-=180}
		hero_rotate=atan/60
}
var counttrees = 10;
var countboxes = 5;
var countshots = 1;
var trees = []
var boxes = []
var shots = []
for(var i=0;i<counttrees;i++){
	trees.push({x:Math.random()*innerWidth-100,y:Math.random()*innerHeight-100,})}
for(var i=0;i<countboxes;i++){
	boxes.push({x:Math.random()*innerWidth-100,y:Math.random()*innerHeight-100,})}
for(var i=0;i<countshots;i++){
	shots.push({x:x,y:y,vx:0,vy:0})}
function bg(){
ctx.clearRect(0,0,innerWidth,innerHeight)
for(var i =0;i<counttrees;i++){
	var t = trees[i];
ctx.drawImage(tree, t.x,t.y,200,200);}
for(var i =0;i<countboxes;i++){
	var b = boxes[i];
ctx.drawImage(box, b.x,b.y,100,100);}
draw()
}
function mouse(){
mx = event.x;
my = event.y;
}
function keyDown() {
    if(event.keyCode == 68) {
        rightPressed = true;
    }
    else if(event.keyCode == 65) {
        leftPressed = true;
    }
    if(event.keyCode == 83) {
    	downPressed = true;
    }
    else if(event.keyCode == 87) {
    	upPressed = true;
    }
}
function keyUp(){
	if(event.keyCode == 68) {
        rightPressed = false;
    }
    else if(event.keyCode == 65) {
        leftPressed = false;
    }
    if(event.keyCode == 83) {
    	downPressed = false;
    }
    else if(event.keyCode == 87) {
    	upPressed = false;
    }
}
setInterval(bg,32)
</script>
</body>
</html>